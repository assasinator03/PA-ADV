<% layout('layout') -%>
<form method="get" action="/agents">
  <div class="row">
    <div><label>Recherche par matricule</label><input type="search" name="q" placeholder="ex: 12345" value="<%= q || '' %>"/></div>
    <div style="display:flex; align-items:flex-end"><button class="btn">Rechercher</button></div>
    <% if (canEdit) { %>
    <div style="display:flex; align-items:flex-end; margin-left:auto"><a class="btn success" href="/agents/new">+ Nouvel agent</a></div>
    <% } %>
  </div>
</form>
<table class="table">
  <thead><tr><th>Matricule</th><th>Nom</th><th>Prénom</th><th>Téléphone</th><th>Grade</th><th>Brigade</th><th></th></tr></thead>
  <tbody>
  <% agents.forEach(a => { %>
    <tr>
      <td><%= a.matricule %></td>
      <td><%= a.lastName %></td>
      <td><%= a.firstName %></td>
      <td><%= a.phone || '-' %></td>
      <td><span class="badge"><%= a.grade %></span></td>
      <td><%= a.brigade || '-' %></td>
      <td style="text-align:right"><a class="btn" href="/agents/<%= a.id %>">Voir</a> <% if (canEdit) { %><a class="btn" href="/agents/<%= a.id %>/edit">Éditer</a><% } %></td>
    </tr>
  <% }) %>
  </tbody>
</table>
